# 모의 컨설팅 과제

---

GitHub repository 

[https://github.com/JoWoonJi/Pentest](https://github.com/JoWoonJi/Pentest)

링크 [JoWoonJi/Pentest: Simulation consulting,Mock hacking,Vulnerability assessment (github.com)](https://github.com/JoWoonJi/Pentest)

---

모의해킹 공격 구상

- [x]  오픈 소스 모의 해킹 사이트 취약점 분석해보기 // 로그인,검색창,피드백submit
- [x]  로그인 폼에 SQL Injection
- [x]  검색창에 XSS 공격
- [ ]  피드백 폼에 파일 업로드 공격, CSRF 공격 실패 // 게시판이나 업로드 공간이 있었다면 파일 업로드 공격이나 웹쉘을 이용한 공격이 좀 더 용이 했을듯

*https://demo.testfire.net/ 사이트에 모의 컨설팅을 진행하였다.
---

# Vulnerability 1. SQL Injection

- 1-1. 로그인 폼에 SQL Injection의 대표적 구문인 ‘ or ‘1’=’1 을 테스트 해 본다. admin 계정이 있을 것으로 추측.

![1](https://github.com/JoWoonJi/Pentest/blob/main/img/1-1.SQL%20Injection%20test.jpg)

---

- 1-2. admin 계정 탈취 성공. 이처럼 SQL Injection은 간단하지만 피해는 상상할 수 없을 정도로 큼.

![2](https://github.com/JoWoonJi/Pentest/blob/main/img/1-2.Jack%20admin.jpg)

---

- 1-3. admin 계정 탈취 시 해당 사이트 피해 가능성. 아래 사진처럼 다른 계좌로 송금이 가능함. 막대한 금전적 손실.

![3](https://github.com/JoWoonJi/Pentest/blob/main/img/1-3.Transfer%20money.jpg)

---

- 1-4 . 기타 피해 사례. 아래 사진처럼 다른 계정의 비밀번호도 바꿀 수 있으며, 새로운 계정을 임의로 추가 할 수도 있음.

![4](https://github.com/JoWoonJi/Pentest/blob/main/img/1-4.Edit%20User.jpg)

---

# 대응 방안

<aside>
💡 
  
  SQL Injection 공격은 웹 애플리케이션의 입력 데이터를 검증하지 않거나, 출력 값을 보안 처리하지 않음으로써 발생한다.

아주 간단한 공격이지만 피해는 상상할 수 없으므로 로그인 페이지에 보안 코딩을 적용해야 한다. 미리 바인딩 시키거나 pstmt(prepared statement)를 활용해 인젝션등을 원천 차단해야 한다.

필터링을 한다면 ', ", ;, /, \, *, ?, %, &, |, ^, ~ 등과 같은 특수문자를 반드시 제한해야한다.

SQL 인코딩을 하고, 인젝션이 가능한 폼에는 재검증하여 반드시 주의해야 한다.

출력값을 SQL 구문에 직접 삽입하지 않도록 해야 SQL Injection 공격을 차단할 수 있다.

</aside>

---

---

---

---

# Vulnerability 2. Cross-Site Scripting(XSS)

- 2-1. 오른쪽 상단의 검색창에 xss 취약점이 있는지 스크립트 구문으로 테스트해 본다.

![1](https://github.com/JoWoonJi/Pentest/blob/main/img/2-1.%20XSS.jpg)

---

- 2-2. 공격자가 입력한 alert 스크립트가 정상적으로 실행된 것이 확인된다.

![2](https://github.com/JoWoonJi/Pentest/blob/main/img/2-2.%20XSS%20script%20alert.jpg)

---

- 2-3. 이처럼 xss 공격이 가능하면 아래 사진의 왼쪽 상단 처럼 board title도 바꿀 수 있고, img src를 활용해 이미지를 삽입하거나 embed 를 활용해 공격자가 원하는 url도 삽입가능하다. 세션 이나 쿠키를 탈취 당하여 막대한 피해를 입을 것으로 예상된다.

![3](https://github.com/JoWoonJi/Pentest/blob/main/img/2-3%20XSS%20board.jpg)

---

# 대응 방안

<aside>
💡 
  
XSS(Cross-Site Scripting)는 웹 애플리케이션의 취약점을 이용하여 악성 스크립트를 사용자의 브라우저에 실행시키는 공격이다.  XSS 공격을 통해 공격자는 사용자의 개인 정보 탈취, 웹사이트의 권한 획득, 악성 코드 유포 등의 피해를 입힐 수 있다.

XSS를 방어하기 위해서는 데이터를 입력할 때와 출력할 때, 모두 필터링하고, 클라이언트에도 막을 수 있을만한 수단을 구성해 놓는 것이 좋다.

필터링을 제작해서 사용할 때는 라이브러리를 활용할 수 있다.

xss 방어를 위한 예시

- 사용자 입력 검증
  `특수 문자 제한: <, >, ', ", /, \ 등과 같은 특수 문자를 제한
  HTML 인코딩: 특수 문자를 HTML 인코딩하여 악성 스크립트로 인식되지 않도록
  스크립트 태그 제거: <script>, </script> 태그를 제거`
- 출력 값 보안 처리
  HTML 인코딩
  스크립트 태그 제거: 출력 값에서 <script>, </script> 태그를 제거.`
- 웹 애플리케이션 보안 강화
  취약점 스캐너 사용: 웹 애플리케이션의 취약점을 자동으로 검사하는 도구를 사용
  코드 검토: 웹 애플리케이션의 코드를 사람이 직접 검토`

</aside>
